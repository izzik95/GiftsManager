import requests
import time

# Вставьте ваш токен
TOKEN = "7544083847:AAH8JqMkrrcsh--WINi9Kjw0bfcRdYH7ex8"
API_URL = f"https://api.telegram.org/bot{TOKEN}/"

def get_updates(offset=None):
    """Получить обновления от Telegram"""
    url = API_URL + "getUpdates"
    params = {"timeout": 100, "offset": offset}
    response = requests.get(url, params=params)
    print("getUpdates Response:", response.json())  # Логируем ответ
    return response.json()

def send_message(chat_id, text):
    """Отправить сообщение пользователю"""
    url = API_URL + "sendMessage"
    payload = {"chat_id": chat_id, "text": text}
    requests.post(url, json=payload)

def get_all_gifts():
    """Тестовый запрос для проверки API и доступных команд"""
    url = API_URL + "getUpdates"
    response = requests.get(url)
    print("API Response:", response.json())  # Логируем полный ответ API
    return []

def handle_command(command, chat_id):
    """Обработка команд от пользователя"""
    if command == "/start":
        welcome_text = (
            "Привет! Я бот для тестирования API.\n"
            "Отправьте любую команду, чтобы посмотреть доступные данные."
        )
        send_message(chat_id, welcome_text)

    elif command == "/show_all_gifts":
        get_all_gifts()  # Вызов тестового метода
        send_message(chat_id, "Проверка доступных данных завершена. Смотрите терминал.")

    else:
        send_message(chat_id, "Неизвестная команда. Попробуйте /show_all_gifts.")

def main():
    offset = None
    while True:
        updates = get_updates(offset)
        for update in updates.get("result", []):
            offset = update["update_id"] + 1
            if "message" in update:
                chat_id = update["message"]["chat"]["id"]
                command = update["message"].get("text", "")
                handle_command(command, chat_id)
        time.sleep(1)

if name == "__main__":
    main()
